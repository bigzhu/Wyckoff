:root {
    --mermaid-primary-bg: #f0f9f4;
    --mermaid-border: #3eaf7c;
    --mermaid-text: #2c3e50;
}

html.dark {
    /* 深度暗色方案，对比度降到最低 */
    --mermaid-primary-bg: #1a1a1c;
    /* 接近黑色 */
    --mermaid-border: #2d5a45;
    /* 极其深绿 */
    --mermaid-text: #8b949e;
    /* 灰色文字，不刺眼 */
}

/* 强制覆盖 Mermaid 内部生成的颜色 */
.mermaid svg {
    background-color: transparent !important;
}

/* 通过 CSS 变量在运行时动态修改样式，这是最稳定支持暗黑模式的方法 */
.mermaid .node rect,
.mermaid .node circle,
.mermaid .node polygon,
.mermaid .node path {
    fill: #f0f9f4 !important;
    /* 默认浅绿 */
    stroke: #3eaf7c !important;
}

.mermaid .node .label,
.mermaid .edgeLabel {
    color: #2c3e50 !important;
    fill: #2c3e50 !important;
}

html.dark .mermaid .node rect,
html.dark .mermaid .node circle,
html.dark .mermaid .node polygon,
html.dark .mermaid .node path {
    fill: var(--mermaid-primary-bg) !important;
    stroke: var(--mermaid-border) !important;
}

html.dark .mermaid .node .label,
html.dark .mermaid .edgeLabel {
    color: var(--mermaid-text) !important;
    fill: var(--mermaid-text) !important;
}

html.dark .mermaid .edgePath .path {
    stroke: var(--mermaid-border) !important;
}

html.dark .mermaid .marker {
    fill: var(--mermaid-border) !important;
}

html.dark .mermaid .messageLine0,
html.dark .mermaid .messageLine1 {
    stroke: var(--mermaid-border) !important;
}